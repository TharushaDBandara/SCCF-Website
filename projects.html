<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Project Details - SCCF</title>
  <link rel="stylesheet" href="assets/styles.css">
  <link rel="stylesheet" href="assets/custom-overrides.css">
  <link rel="stylesheet" href="assets/chatbot.css">
  <style>
    /* Force full-width sticky header on this page (override floating glass) */
    body[data-page='project'] header,
    body[data-page='project'] header.scrolled,
    body[data-page='project'] header.visible,
    body[data-page='project'] header.hidden {
      position: sticky !important;
      top: 0 !important;
      left: 0 !important;
      transform: none !important;
      width: 100% !important;
      max-width: none !important;
      border-radius: 0 !important;
      opacity: 1 !important;
      background: rgba(255,255,255,0.97) !important;
      box-shadow: var(--shadow-lg) !important;
    }
    /* Neutralize global section top line */
    body[data-page='project'] .section::before { display: none !important; height: 0 !important; }

    /* Page-local layout */
    .p-container { padding-left: 1rem; padding-right: 1rem; max-width: 1200px; margin: 0 auto; }
    .p-main { padding-top: 0; }
    .p-back { display:inline-block; margin: .5rem 0 1rem; }
    .p-header { margin: 0 0 1rem; }
    .p-title { font-size: clamp(1.9rem, 2.2vw + 1rem, 2.6rem); font-weight: 800; margin: .25rem 0 .5rem; }
    .p-summary { display: none; } /* Hide summary in header to avoid redundancy with long description */
    /* Compact, centered cover: reduce width and height proportionally */
    .p-cover { 
      margin: 0.5rem auto 0.75rem; /* center */
      width: min(100%, 900px);     /* reduce width on large screens */
      overflow:hidden; 
      border-radius: 14px; 
      box-shadow: var(--shadow-lg); 
    }
    .p-cover img { 
      width: 100%; 
      height: clamp(220px, 32vw, 360px); /* responsive height bound */
      object-fit: cover; 
      display:block; 
    }

    /* Breadcrumbs + meta */
    .p-breadcrumbs { font-size: .9rem; color: var(--text-secondary); display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
    .p-breadcrumbs a { color: var(--accent); text-decoration: none; }
    .p-breadcrumbs .sep { opacity:.6; }
    .p-meta { display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; margin:.5rem 0 0; }
    .pill { display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .7rem; border-radius:999px; font-size:.75rem; font-weight:700; letter-spacing:.4px; border:1px solid var(--border); background: rgba(112,165,190,.12); color: var(--primary); }
    .pill.status { background: rgba(16,185,129,.1); border-color: rgba(16,185,129,.25); color: #059669; }
    .share-btn { display:inline-flex; align-items:center; gap:.4rem; padding:.45rem .8rem; border-radius:999px; border:1px solid var(--border); background:#fff; color:var(--accent); cursor:pointer; transition:var(--transition); }
    .share-btn:hover { transform: translateY(-1px); box-shadow: var(--shadow); }
    .share-btn svg { width:16px; height:16px; }

  .p-info { margin: .5rem 0 2rem; display: grid; gap: 1rem; grid-template-columns: 1fr; }
  /* Keep single column layout so stats take full width */
  @media (min-width: 900px) { .p-info { grid-template-columns: 1fr; } }
  .p-card { display:none; }
    .p-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); }
    .p-card strong { color: var(--primary); }
  .p-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; }
    .p-stat { text-align:center; background: var(--background-secondary); border-radius: 14px; padding: 1rem; border:1px solid var(--border); position:relative; overflow:hidden; }
    .p-stat::before { content:''; position:absolute; inset:auto 0 0 0; height:4px; background: var(--gradient-accent); }
    .p-stat .num { display:block; font-size: clamp(1.25rem, 1.6vw, 2rem); font-weight: 800; color: var(--accent); }
    .p-stat .label { font-size:.8rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing:.6px; }

    .p-desc { margin: 1.5rem 0 2rem; }
    .p-desc p { margin: 0 0 1rem; font-size: 1.05rem; line-height: 1.85; color: var(--text-secondary); }
    .p-desc .lead { 
      font-size: 1.15rem; 
      line-height: 1.75; 
      color: var(--text); 
      font-weight: 400;
      margin-bottom: 1.5rem;
    }
    /* Add visual separator before description */
    .p-desc::before {
      content: '';
      display: block;
      width: 60px;
      height: 3px;
      background: var(--gradient-accent);
      margin-bottom: 1.5rem;
      border-radius: 2px;
    }

    .p-gallery { margin: 1rem 0 2rem; }
    .p-gallery h2 { margin: 0 0 .75rem; }
    .p-grid { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 12px; }
    @media (min-width: 800px) { .p-grid { grid-template-columns: repeat(4, minmax(0,1fr)); } }
    .p-grid .item { position:relative; overflow:hidden; border-radius: 12px; border:1px solid var(--border); background:#fff; box-shadow: var(--shadow); }
    .p-grid .item::after { content:''; position:absolute; inset:0; background:linear-gradient(180deg, rgba(21,37,48,0) 0%, rgba(21,37,48,0.08) 100%); opacity:0; transition:var(--transition); }
    .p-grid .item:hover::after { opacity:1; }
    .p-grid .item img { width: 100%; height: auto; display:block; transition: transform .35s ease; }
    .p-grid .item:hover img { transform: scale(1.06); }

    /* Lightbox */
    .lb-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.7); display: none; align-items: center; justify-content: center; z-index: 2000; }
    .lb-backdrop.active { display: flex; }
    .lb-frame { max-width: min(92vw, 1200px); max-height: 86vh; position: relative; }
    .lb-img { width: 100%; height: auto; border-radius: 12px; box-shadow: var(--shadow-xl); display:block; }
    .lb-close, .lb-prev, .lb-next { position:absolute; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,.9); border:1px solid var(--border); color: var(--primary); width: 44px; height: 44px; border-radius: 999px; display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow: var(--shadow); }
    .lb-close { top: -16px; right: -16px; transform: none; }
    .lb-prev { left: -16px; }
    .lb-next { right: -16px; }
    .lb-close:hover, .lb-prev:hover, .lb-next:hover { background:#fff; }

    .lb-caption { position:absolute; left: 0; right: 0; bottom: -48px; display:flex; justify-content: space-between; align-items:center; color:#fff; font-size:.9rem; }
    .lb-caption .count { opacity:.85; }
    @media (max-width: 700px){ .lb-prev, .lb-next { display:none; } .lb-caption { font-size:.85rem; } }

    /* Related projects */
    .p-related { margin: 2rem 0 3rem; }
    .p-related h2 { margin: 0 0 1rem; }
  </style>
  <script defer src="assets/main.js"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17705728933"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());

    gtag('config', 'AW-17705728933');
  </script>
</head>
<body data-page="project">
  <header>
    <nav class="navbar" aria-label="Main Navigation">
      <a href="index.html#home" class="logo" aria-label="SCCF Home">
        <img src="assets/logo.png" width="40" height="40" alt="SCCF Logo" class="logo-icon">
      </a>
      <div class="nav-content">
        <ul id="nav-menu" class="nav-menu">
          <li><a href="index.html#home" data-en="Home" data-si="මුල් පිටුව" data-ta="முகப்பு">Home</a></li>
          <li><a href="index.html#about" data-en="About Us" data-si="අප ගැන" data-ta="எங்களைப் பற්றி">About Us</a></li>
          <li class="active"><a href="projects-list.html" data-en="Projects" data-si="ව්‍යාපෘති" data-ta="திட்டங்கள்">Projects</a></li>
          <li><a href="gallery.html" data-en="Gallery" data-si="ගැලරිය" data-ta="தொகுப்பு">Gallery</a></li>
          <li><a href="index.html#get-involved" data-en="Get Involved" data-si="සහභාගී වන්න" data-ta="பங்கேற்க">Get Involved</a></li>
          <li><a href="index.html#contact" data-en="Contact" data-si="සම්බන්ධ වන්න" data-ta="தொடர்பு">Contact</a></li>
        </ul>
        <div class="language-toggle">
          <button class="lang-btn active" data-lang="en" aria-label="English">EN</button>
          <button class="lang-btn" data-lang="si" aria-label="Sinhala">සි</button>
          <button class="lang-btn" data-lang="ta" aria-label="Tamil">த</button>
        </div>
      </div>
      <div class="navbar-social">
        <a href="https://www.facebook.com/share/1C3uFeETFy/" aria-label="Follow us on Facebook" class="social-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
        <a href="https://instagram.com/sccf" aria-label="Follow us on Instagram" class="social-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></a>
  <a href="https://wa.me/94701365412" aria-label="Contact us on WhatsApp" class="social-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893A11.821 11.821 0 0 0 20.51 3.488"/></svg></a>
      </div>
      <button class="nav-toggle" aria-label="Open navigation menu" aria-controls="nav-menu" aria-expanded="false">
        <span class="hamburger"></span>
      </button>
    </nav>
  </header>

  <main class="p-container p-main" id="page-main">
  <a href="projects-list.html" class="btn p-back">← Back to Projects</a>

    <section class="p-header" id="project-header">
      <div class="p-breadcrumbs" aria-label="Breadcrumb">
        <a href="index.html#home">Home</a>
        <span class="sep">/</span>
        <a href="projects-list.html">Projects</a>
        <span class="sep">/</span>
        <span id="crumb-title">Loading…</span>
      </div>
      <h1 id="title" class="p-title">Loading…</h1>
      <div class="p-meta">
        <span id="badge-category" class="pill" hidden></span>
        <span id="badge-status" class="pill status" hidden></span>
        <button id="share-btn" class="share-btn" type="button" aria-label="Share this project">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 8.5L9 12l6 3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="18" cy="6" r="3" stroke="currentColor" stroke-width="2"/><circle cx="6" cy="12" r="3" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="18" r="3" stroke="currentColor" stroke-width="2"/></svg>
          <span>Share</span>
        </button>
      </div>
      <p id="summary" class="p-summary"></p>
      <div class="p-cover" id="cover-wrap" hidden><img id="cover" alt="Project cover"></div>
    </section>

    <section class="p-info" id="project-info">
      <div class="p-card"><p><strong>Category:</strong> <span id="category"></span> &nbsp;|&nbsp; <strong>Status:</strong> <span id="status"></span></p></div>
      <div class="p-stats" id="stats"></div>
    </section>

    <section class="p-desc" id="project-desc"><div id="description"></div></section>

    <section id="gallery" class="p-gallery" hidden>
      <h2 data-en="Project Gallery" data-si="විධානයේ ඡායාරූප" data-ta="திட்டத் தொகுப்பு">Project Gallery</h2>
      <div class="p-grid" id="gallery-grid"></div>
    </section>
  </main>

  <footer class="footer" role="contentinfo" aria-label="Site footer">
    <div class="p-container">
      <div class="footer-content">
        <!-- About Section -->
        <div class="footer-section footer-about-section">
          <div class="footer-logo-box">
            <img src="assets/logo/white.svg" alt="Social Community Contribution Foundation Logo">
          </div>
          <p>Empowering communities through collective action, sustainable development, and civic engagement across Sri Lanka.</p>
          
          <!-- Social Media Links -->
          <div class="footer-social">
            <a href="https://www.facebook.com/share/1C3uFeETFy/" aria-label="Follow us on Facebook" class="footer-social-link" target="_blank" rel="noopener noreferrer">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
            </a>
            <a href="https://instagram.com/sccf" aria-label="Follow us on Instagram" class="footer-social-link" target="_blank" rel="noopener noreferrer">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
            </a>
            <a href="https://wa.me/94701365412" aria-label="Contact us on WhatsApp" class="footer-social-link" target="_blank" rel="noopener noreferrer">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893A11.821 11.821 0 0020.51 3.488"/>
              </svg>
            </a>
          </div>
        </div>
        
        <!-- Quick Links -->
        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="index.html#home">Home</a></li>
            <li><a href="index.html#about">About Us</a></li>
            <li><a href="projects-list.html">Our Projects</a></li>
            <li><a href="news.html">News & Updates</a></li>
            <li><a href="gallery.html">Gallery</a></li>
            <li><a href="index.html#get-involved">Get Involved</a></li>
          </ul>
        </div>
        
        <!-- Programs -->
        <div class="footer-section">
          <h4>Our Programs</h4>
          <ul>
            <li><a href="gallery.html?filter=education">Education</a></li>
            <li><a href="gallery.html?filter=healthcare">Healthcare</a></li>
            <li><a href="gallery.html?filter=community">Community Development</a></li>
            <li><a href="gallery.html?filter=environment">Environment</a></li>
            <li><a href="gallery.html?filter=empowerment">Youth Empowerment</a></li>
            <li><a href="gallery.html?filter=events">Events</a></li>
          </ul>
        </div>
        
        <!-- Contact & Legal -->
        <div class="footer-section">
          <h4>Contact Us</h4>
          <ul class="footer-contact-list">
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
              <a href="mailto:contact@sccflk.org">contact@sccflk.org</a>
            </li>
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
              <a href="tel:+94701365412">+94 70 136 5412</a>
            </li>
            <li>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
              <span>Sri Lanka</span>
            </li>
          </ul>
          
          <h4 class="footer-legal-heading">Legal</h4>
          <ul>
            <li><a href="index.html#get-involved">Volunteer</a></li>
            <li><a href="#privacy-policy">Privacy Policy</a></li>
            <li><a href="#terms">Terms of Service</a></li>
          </ul>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p>&copy; 2025 Social Community Contribution Foundation. All rights reserved.</p>
        <button id="back-to-top" class="back-to-top" aria-label="Back to top">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <line x1="12" y1="19" x2="12" y2="5"></line>
            <polyline points="5 12 12 5 19 12"></polyline>
          </svg>
        </button>
      </div>
    </div>
  </footer>

  <!-- Lightbox -->
  <div id="lightbox" class="lb-backdrop" role="dialog" aria-modal="true" aria-label="Image viewer">
    <div class="lb-frame">
      <img id="lb-img" class="lb-img" alt="Project image" />
      <button class="lb-close" id="lb-close" aria-label="Close">✕</button>
      <button class="lb-prev" id="lb-prev" aria-label="Previous">‹</button>
      <button class="lb-next" id="lb-next" aria-label="Next">›</button>
      <div class="lb-caption"><span class="count" id="lb-count"></span><span class="title" id="lb-title"></span></div>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const id = params.get('id');
    const API_BASE = (location.hostname === 'localhost' || location.hostname === '127.0.0.1') ? 'http://127.0.0.1:5000' : '';
    function escapeHtml(str){ return String(str||'').replace(/[&<>"']/g, s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'})[s]); }
    function resolveMedia(url){ 
      if(!url) return ''; 
      // Dev: point /uploads/* to the admin server
      if (API_BASE && typeof url === 'string' && url.startsWith('/uploads/')) {
        return API_BASE + url;
      }
      // Static/Prod: map /uploads/* to assets/uploads/* mirror
      if (!API_BASE && typeof url === 'string' && url.startsWith('/uploads/')) {
        return 'assets' + url; 
      }
      if(API_BASE && typeof url==='string' && url.startsWith('/')) return API_BASE+url; 
      return url; 
    }
    function fetchFromAPI(pid){ if(!API_BASE) return Promise.resolve(null); return fetch(API_BASE + '/api/projects/' + encodeURIComponent(pid)).then(r=>r.ok?r.json():null).catch(()=>null); }
    function fetchFromStatic(pid){ return fetch('assets/projects.json', { cache: 'no-store' }).then(r=>r.ok?r.json():[]).then(list=>Array.isArray(list)?list.find(p=>String(p.id)===String(pid)):null).catch(()=>null); }

    // Apply a precise top padding equal to current header height + spacing
    function applyHeaderOffset(){
      const header = document.querySelector('header');
      const mainEl = document.getElementById('page-main');
      if (!header || !mainEl) return;
      const h = header.getBoundingClientRect().height || 0;
      mainEl.style.paddingTop = (h + 16) + 'px'; // 16px breathing space
    }
    window.addEventListener('resize', applyHeaderOffset);
    document.addEventListener('DOMContentLoaded', applyHeaderOffset);

    (id ? fetchFromAPI(id).then(p=>p||fetchFromStatic(id)) : Promise.resolve(null))
      .then(proj => {
        if(!proj){ document.getElementById('title').textContent = 'Project not found'; return; }
        applyHeaderOffset();

        // Title + summary
        const t = document.getElementById('title');
        const s = document.getElementById('summary');
        const crumb = document.getElementById('crumb-title');
        t.setAttribute('data-en', proj.title?.en || proj.title || '');
        t.setAttribute('data-si', proj.title?.si || '');
        t.setAttribute('data-ta', proj.title?.ta || '');
        t.textContent = proj.title?.en || proj.title || '';
        if (crumb) crumb.textContent = proj.title?.en || proj.title || '';
        s.setAttribute('data-en', proj.summary?.en || proj.summary || '');
        s.setAttribute('data-si', proj.summary?.si || '');
        s.setAttribute('data-ta', proj.summary?.ta || '');
        s.textContent = proj.summary?.en || proj.summary || '';

        // Cover image
        const rawCover = (proj.main_image || proj.image || '') || '';
  // Prefer mirrored assets/uploads first on static hosting; fall back to bundled /server/uploads
  const coverUrl = (!API_BASE && typeof rawCover === 'string' && rawCover.startsWith('/uploads/')) ? ('assets' + rawCover) : resolveMedia(rawCover);
        const coverWrap = document.getElementById('cover-wrap');
        if (coverUrl) {
          const img = document.getElementById('cover');
          const altPath = (!API_BASE && typeof rawCover === 'string' && rawCover.startsWith('/uploads/')) ? ('server' + rawCover) : ((typeof rawCover === 'string' && rawCover.startsWith('/uploads/')) ? ('/server' + rawCover) : '');
          img.src = coverUrl; img.alt = proj.title?.en || proj.title || 'Project image';
          if (altPath) { img.setAttribute('data-alt', altPath); img.onerror = function(){ const a=this.getAttribute('data-alt'); if(a){ this.removeAttribute('data-alt'); this.src=a; } }; }
          coverWrap.hidden = false;
        } else {
          coverWrap.hidden = true;
        }
        // Move meta (category/status pills + share) below the cover for a cleaner layout
        try { const meta = document.querySelector('.p-meta'); if (meta && coverWrap && !coverWrap.hidden) { coverWrap.insertAdjacentElement('afterend', meta); } } catch {}

        // Meta + stats
        const catText = proj.category || '';
        const statusText = proj.status || '';
        document.getElementById('category').textContent = catText;
        document.getElementById('status').textContent = statusText;
        const bcat = document.getElementById('badge-category');
        const bsta = document.getElementById('badge-status');
        if (bcat) { bcat.textContent = catText; bcat.hidden = !catText; }
        if (bsta) { bsta.textContent = statusText; bsta.hidden = !statusText; }
        const stats = document.getElementById('stats');
        stats.innerHTML = '';
        const addStat = (st) => {
          const d=document.createElement('div'); d.className='p-stat';
          d.innerHTML = `<span class='num'>${escapeHtml(st.number||'')}</span><span class='label' data-en='${escapeHtml(st.label?.en||'')}' data-si='${escapeHtml(st.label?.si||'')}' data-ta='${escapeHtml(st.label?.ta||'')}'>${escapeHtml(st.label?.en||'')}</span>`;
          stats.appendChild(d);
        };
        if (proj.stat1) addStat(proj.stat1);
        if (proj.stat2) addStat(proj.stat2);

        // Description (support both description.long... and longDescription shapes)
        const desc = document.getElementById('description');
        const longEn = (proj.description && (proj.description.en || proj.description.long_en)) || proj.longDescription?.en || '';
        const longSi = (proj.description && (proj.description.si || proj.description.long_si)) || proj.longDescription?.si || '';
        const longTa = (proj.description && (proj.description.ta || proj.description.long_ta)) || proj.longDescription?.ta || '';
        
        // Use long description if available, fallback to summary if long description is empty
        const finalEn = longEn || proj.summary?.en || proj.summary || '';
        const finalSi = longSi || proj.summary?.si || '';
        const finalTa = longTa || proj.summary?.ta || '';
        
        if (finalEn || finalSi || finalTa) {
          const p = document.createElement('p'); p.className='lead';
          p.setAttribute('data-en', escapeHtml(finalEn));
          p.setAttribute('data-si', escapeHtml(finalSi));
          p.setAttribute('data-ta', escapeHtml(finalTa));
          p.textContent = finalEn;
          desc.appendChild(p);
        }

        // Gallery
        const gallery = Array.isArray(proj.gallery_images) ? proj.gallery_images : [];
        if (gallery.length) {
          document.getElementById('gallery').hidden = false;
          const grid = document.getElementById('gallery-grid');
          grid.innerHTML = '';
          gallery.forEach((u, idx) => {
            const div = document.createElement('div');
            div.className = 'item';
            div.setAttribute('data-category', proj.category || 'community');
            const rawU = u || '';
            const primaryU = (!API_BASE && typeof rawU === 'string' && rawU.startsWith('/uploads/')) ? ('assets' + rawU) : resolveMedia(u);
            const altU = (!API_BASE && typeof rawU === 'string' && rawU.startsWith('/uploads/')) ? ('server' + rawU) : ((typeof rawU === 'string' && rawU.startsWith('/uploads/')) ? ('/server' + rawU) : '');
            div.innerHTML = `<img data-idx='${String(idx)}' src='${escapeHtml(primaryU)}' ${altU ? `data-alt='${escapeHtml(altU)}'` : ''} alt='${escapeHtml(proj.title?.en || 'Project image')}' onerror="if(this.dataset.alt){var a=this.dataset.alt; this.dataset.alt=''; this.src=a;} else { this.onerror=null; }" />`;
            grid.appendChild(div);
          });
        }

        // Apply saved language
        try { const lang = localStorage.getItem('preferredLanguage') || 'en'; if (typeof switchLanguage === 'function') switchLanguage(lang); } catch {}

        // Share button
        try {
          const shareBtn = document.getElementById('share-btn');
          if (shareBtn) {
            const shareData = {
              title: proj.title?.en || proj.title || 'SCCF Project',
              text: proj.summary?.en || proj.summary || 'Check out this SCCF project',
              url: window.location.href
            };
            shareBtn.addEventListener('click', async () => {
              if (navigator.share) {
                try { await navigator.share(shareData); } catch {}
              } else {
                try { await navigator.clipboard.writeText(shareData.url); alert('Link copied to clipboard'); } catch { prompt('Copy this link:', shareData.url); }
              }
            });
          }
        } catch {}

        // Lightbox wiring
        try {
          const lb = document.getElementById('lightbox');
          const lbImg = document.getElementById('lb-img');
          const lbCount = document.getElementById('lb-count');
          const lbTitle = document.getElementById('lb-title');
          const btnClose = document.getElementById('lb-close');
          const btnPrev = document.getElementById('lb-prev');
          const btnNext = document.getElementById('lb-next');
          const imgs = Array.from(document.querySelectorAll('#gallery-grid img'));
          let current = 0;
          function show(i){ if(!imgs.length) return; current = (i+imgs.length)%imgs.length; const src = imgs[current].getAttribute('src'); lbImg.src = src; lb.classList.add('active'); document.body.style.overflow='hidden'; if(lbCount) lbCount.textContent = (current+1) + ' / ' + imgs.length; if(lbTitle) lbTitle.textContent = (proj.title?.en || proj.title || ''); btnClose?.focus(); }
          function hide(){ lb.classList.remove('active'); document.body.style.overflow=''; }
          imgs.forEach((img, i)=>{ img.style.cursor='zoom-in'; img.addEventListener('click', ()=> show(i)); });
          btnClose?.addEventListener('click', hide);
          btnPrev?.addEventListener('click', ()=> show(current-1));
          btnNext?.addEventListener('click', ()=> show(current+1));
          lb?.addEventListener('click', (e)=>{ if(e.target===lb) hide(); });
          window.addEventListener('keydown', (e)=>{ if(!lb.classList.contains('active')) return; if(e.key==='Escape') hide(); if(e.key==='ArrowLeft') show(current-1); if(e.key==='ArrowRight') show(current+1); });
        } catch {}

        // Related projects (same category)
        try {
          const relWrap = document.createElement('section');
          relWrap.className = 'p-related';
          relWrap.innerHTML = `<h2 data-en='Related Projects'>Related Projects</h2><div class='projects-grid' id='related-grid'></div>`;
          document.getElementById('page-main')?.appendChild(relWrap);

          const API_BASE2 = (location.hostname === 'localhost' || location.hostname === '127.0.0.1') ? 'http://127.0.0.1:5000' : '';
          const fetchAll = API_BASE2 ? fetch(API_BASE2 + '/api/projects').then(r=>r.json()).catch(()=>null) : Promise.resolve(null);
          const fallback = () => fetch('assets/projects.json').then(r=>r.json()).catch(()=>[]);
          (fetchAll.then(d=>d||fallback()).catch(()=>fallback())).then(all => {
            if (!Array.isArray(all)) return;
            const list = all.filter(p => String(p.id) !== String(id) && (p.category||'') === (proj.category||''));
            const top = list.slice(0, 3);
            const grid = document.getElementById('related-grid');
            if (!grid || !top.length) { relWrap.remove(); return; }
            top.forEach(pj => {
              const rawRel = (pj.main_image || pj.image || '') || '';
              const imgSrc = (!API_BASE && typeof rawRel === 'string' && rawRel.startsWith('/uploads/')) ? ('assets' + rawRel) : resolveMedia(rawRel);
              const altRel = (!API_BASE && typeof rawRel === 'string' && rawRel.startsWith('/uploads/')) ? ('server' + rawRel) : ((typeof rawRel === 'string' && rawRel.startsWith('/uploads/')) ? ('/server' + rawRel) : '');
              const card = document.createElement('article');
              card.className = 'project-card';
              card.setAttribute('data-category', (pj.category||'').trim());
              card.innerHTML = `
                <div class="project-image">
                  <img src="${imgSrc}" ${altRel ? `data-alt=\"${altRel}\"` : ''} alt="${escapeHtml(pj.title?.en || pj.title || 'Project')}" loading="lazy" onerror="if(this.dataset.alt){var a=this.dataset.alt; this.dataset.alt=''; this.src=a;} else { this.onerror=null; this.src='assets/images/education/e1.jpg'; }">
                  <div class="project-overlay"><div class="project-overlay-content">
                    <h3 data-en="${escapeHtml(pj.title?.en || pj.title)}">${escapeHtml(pj.title?.en || pj.title)}</h3>
                    <a href="projects.html?id=${encodeURIComponent(pj.id)}" class="btn-overlay" data-en="Learn More">Learn More</a>
                  </div></div>
                </div>
                <div class="project-content">
                  <div class="project-meta">
                    <span class="project-category" data-en="${escapeHtml(pj.category || '')}">${escapeHtml(pj.category || '')}</span>
                    <span class="project-status" data-en="${escapeHtml(pj.status || '')}">${escapeHtml(pj.status || '')}</span>
                  </div>
                  <h3 data-en="${escapeHtml(pj.title?.en || pj.title)}">${escapeHtml(pj.title?.en || pj.title)}</h3>
                  <p data-en="${escapeHtml(pj.summary?.en || pj.summary || '')}">${escapeHtml(pj.summary?.en || pj.summary || '')}</p>
                  <a href="projects.html?id=${encodeURIComponent(pj.id)}" class="project-link" data-en="Learn More">Learn More</a>
                </div>`;
              grid.appendChild(card);
            });
            try { if (typeof switchLanguage === 'function') { const lang = localStorage.getItem('preferredLanguage') || 'en'; switchLanguage(lang); } } catch {}
          });
        } catch {}
      })
      .catch(err => { console.error(err); document.getElementById('title').textContent = 'Failed to load project data'; });
  </script>

  <!-- Chatbot Widget -->
  <div id="sccf-chatbot"></div>
  <script src="assets/chatbot.js" defer></script>
</body>
</html>
